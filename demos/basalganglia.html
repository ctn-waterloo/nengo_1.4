

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Basal Ganglia &#8212; Nengo 1.4 1.4 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cycling through a SP sequence" href="spa_sequence.html" />
    <link rel="prev" title="Controlled oscillator" href="controlledoscillator.html" />
<link rel="stylesheet" type="text/css" href="../_static/custom.css">


  
   

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="spa_sequence.html" title="Cycling through a SP sequence"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="controlledoscillator.html" title="Controlled oscillator"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Nengo 1.4 1.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Demos</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
        <a href="
    ../index.html" class="text-logo">Nengo 1.4</a>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos/index.html">Video tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Written tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#introductory-demos">Introductory demos</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#simple-transformations">Simple transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#dynamics">Dynamics</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#basal-ganglia-based-simulations">Basal Ganglia based simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#learning">Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/index.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nef_algorithm.html">The NEF Algorithm</a></li>
</ul>

    
  </div>
</div>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="index.html">Demos</a></li>
              
              <li>Basal Ganglia</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="basal-ganglia">
<h1>Basal Ganglia<a class="headerlink" href="#basal-ganglia" title="Permalink to this headline">¶</a></h1>
<p><strong>Purpose</strong>:
This demo introduces the basal ganglia model
that the SPA exploits to do action selection.</p>
<p><strong>Comments</strong>:
This is the basal ganglia in isolation, not hooked up to anything.
It demonstrates that this model operates as expected;
i.e., it supresses the output corresponding
to the input with the highest input value.</p>
<p>This is an extension to a spiking, dynamic model
of the Redgrave et al. work.
It is more fully described in several CNRG lab publications.
It exploits the “nps” class from Nengo.</p>
<p><strong>Usage</strong>:
After running the demo, play with the 5 input sliders.
The highest slider should always be selected in the output.
When they are close, interesting things happen.
You may even be able to tell that things
are selected more quickly for larger differences in input values.</p>
<a class="reference internal image-reference" href="../_images/basalganglia.png"><img alt="../_images/basalganglia.png" src="../_images/basalganglia.png" style="width: 100%;" /></a>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">nef</span>
<span class="kn">import</span> <span class="nn">nps</span>

<span class="n">D</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Create the network object</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">nef</span><span class="o">.</span><span class="n">Network</span><span class="p">(</span><span class="s1">&#39;Basal Ganglia&#39;</span><span class="p">)</span>

<span class="c1"># Create a controllable input function with starting value all zeros</span>
<span class="n">net</span><span class="o">.</span><span class="n">make_input</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span>

<span class="c1"># Make a direct mode population with 100 neurons and 5 dimensions</span>
<span class="n">net</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;direct&#39;</span><span class="p">)</span>

<span class="c1"># Make a basal ganglia model with 50 neurons per action</span>
<span class="n">nps</span><span class="o">.</span><span class="n">basalganglia</span><span class="o">.</span><span class="n">make_basal_ganglia</span><span class="p">(</span>
    <span class="n">net</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">same_neurons</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">neurons</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">net</span><span class="o">.</span><span class="n">add_to_nengo</span><span class="p">()</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Video:</p>
<iframe width="100%" height="400" src="https://www.youtube.com/embed/5latplytFwM" frameborder="0" allowfullscreen></iframe><div class="toggle docutils container">
<div class="header docutils container">
<strong>Transcript</strong></div>
<p>This video shows a simulation of the basal ganglia circuit,
whose network structure is shown here on the right.
The input can be thought of as cortex
and the output is going to thalamus.
This graph shows the output
and the input is controlled by these 5 sliders.</p>
<p>Let me start the simulation.
When a given cortical state has a high value
its corresponding action should be selected by thalamus.
This can be seen in the graph below.
Here, selection means decreasing the activity
of the corresponding action because basal ganglia
is known to release thalamus from inhibition.</p>
<p>Notably, there is little response of the circuit
to negative values or values below about .3.
Nevertheless the circuit can select
the most valuable state as soon as one of the actions
goes significantly higher than .3
regardless of the value of the other states.
In addition, the bigger the difference,
the more clear the selected activity is.</p>
<p>Notice that when several competing states have high,
near threshold values the dynamics of the circuit
still allow it to make fine distinctions.
For instance, here it can distinguish a difference
of only .06, selecting the highest action appropriately.
As I move the slider back to near
the threshold value the corresponding action
quickly becomes indistinguishable from other possible actions.</p>
<p>Critically the specific dynamics we see here,
while looking something like a winner take all circuit,
are much more sophisticated than the dynamics
we would get by merely inhibitorily connecting cells.
Specifically, this network responds particularly quickly,
and over a wider range of possible network inputs.</p>
</div>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="controlledoscillator.html" title="previous chapter (use the left arrow)">Controlled oscillator</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="spa_sequence.html" title="next chapter (use the right arrow)">Cycling through a SP sequence</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="spa_sequence.html" title="Cycling through a SP sequence"
             >next</a> |</li>
        <li class="right" >
          <a href="controlledoscillator.html" title="Controlled oscillator"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Nengo 1.4 1.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Demos</a> &#187;</li> 
      </ul>
    </div>
  <script type="text/javascript">
    $(document).ready(function() {
      $(".toggle > *").hide();
      $(".toggle .header").show();
      $(".toggle .header").click(function() {
        $(this).parent().children().not(".header").toggle(400);
        $(this).parent().children(".header").toggleClass("open");
      });
    });
  </script>

<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2006-2017, Bryan Tripp & Centre for Theoretical Neuroscience, University of Waterloo. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>