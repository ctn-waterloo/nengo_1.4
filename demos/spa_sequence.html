

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  
  <!-- Licensed under the Apache 2.0 License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/open-sans/stylesheet.css" />
  <!-- Licensed under the SIL Open Font License -->
  <link rel="stylesheet" type="text/css" href="../_static/fonts/source-serif-pro/source-serif-pro.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap.min.css" />
  <link rel="stylesheet" type="text/css" href="../_static/css/bootstrap-theme.min.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    <title>Cycling through a SP sequence &#8212; Nengo 1.4 1.4 documentation</title>
    <link rel="stylesheet" href="../_static/guzzle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Routed sequencing" href="spa_sequencerouted.html" />
    <link rel="prev" title="Basal Ganglia" href="basalganglia.html" />
<link rel="stylesheet" type="text/css" href="../_static/custom.css">


  
   

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="spa_sequencerouted.html" title="Routed sequencing"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="basalganglia.html" title="Basal Ganglia"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Nengo 1.4 1.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">Demos</a> &#187;</li> 
      </ul>
    </div>
    <div class="container-wrapper">

      <div id="mobile-toggle">
        <a href="#"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span></a>
      </div>
  <div id="left-column">
    <div class="sphinxsidebar">
        <a href="
    ../index.html" class="text-logo">Nengo 1.4</a>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <h2>Table Of Contents</h2>
  </div>
  <div class="sidebar-toc">
    
    
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../videos/index.html">Video tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Written tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#introductory-demos">Introductory demos</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#simple-transformations">Simple transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#dynamics">Dynamics</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#basal-ganglia-based-simulations">Basal Ganglia based simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#learning">Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../scripting/index.html">Scripting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/index.html">Advanced usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nef_algorithm.html">The NEF Algorithm</a></li>
</ul>

    
  </div>
</div>
        
<div class="sidebar-block">
  <div class="sidebar-wrapper">
    <div id="main-search">
      <form class="form-inline" action="../search.html" method="GET" role="form">
        <div class="input-group">
          <input name="q" type="text" class="form-control" placeholder="Search...">
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div>
    </div>
  </div>
        <div id="right-column">
          
          <div role="navigation" aria-label="breadcrumbs navigation">
            <ol class="breadcrumb">
              <li><a href="../index.html">Docs</a></li>
              
                <li><a href="index.html">Demos</a></li>
              
              <li>Cycling through a SP sequence</li>
            </ol>
          </div>
          
          <div class="document clearer body">
            
  <div class="section" id="cycling-through-a-sp-sequence">
<h1>Cycling through a SP sequence<a class="headerlink" href="#cycling-through-a-sp-sequence" title="Permalink to this headline">¶</a></h1>
<p><strong>Purpose</strong>:
This demo uses the basal ganglia model
to cycle through a 5 element sequence of semantic pointers.</p>
<p><strong>Comments</strong>:
This basal ganglia is now hooked up to a memory.
This allows it to update that memory
based on its current input/action mappings.
The mappings are defined in the code
such that A -&gt; B, B -&gt; C, …, E -&gt; A, completing a loop.
This uses the “spa” module from Nengo.</p>
<p>The “utility” graph shows the utility
of each rule going into the basal ganglia.
The “rule” graph shows which one has been selected
and is driving thalamus.</p>
<p><strong>Usage</strong>:
When you run the network,
it will go through the sequence forever.
It’s interesting to note the distance
between the “peaks” of the selected items.
It’s about 40 ms for this simple action.
We like to make a big deal of this.</p>
<a class="reference internal image-reference" href="../_images/spa_sequence.png"><img alt="../_images/spa_sequence.png" src="../_images/spa_sequence.png" style="width: 100%;" /></a>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spa</span> <span class="k">import</span> <span class="o">*</span>


<span class="c1"># Define the rules by specifying the start state and the desired next state</span>
<span class="k">class</span> <span class="nc">Rules</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">A</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">):</span>  <span class="c1"># If in state A...</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>  <span class="c1"># then go to state B</span>

    <span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">):</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">C</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">):</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">):</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">E</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">):</span>
        <span class="nb">set</span><span class="p">(</span><span class="n">state</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>


<span class="c1"># Define an SPA model (cortex, basal ganglia, thalamus)</span>
<span class="k">class</span> <span class="nc">Sequence</span><span class="p">(</span><span class="n">SPA</span><span class="p">):</span>
    <span class="n">dimensions</span> <span class="o">=</span> <span class="mi">16</span>
    <span class="c1"># Working memory (recurrent network) object (i.e., Buffer)</span>
    <span class="n">state</span> <span class="o">=</span> <span class="n">Buffer</span><span class="p">()</span>
    <span class="c1"># A basal ganglia with the prespecified set of rules</span>
    <span class="n">BG</span> <span class="o">=</span> <span class="n">BasalGanglia</span><span class="p">(</span><span class="n">Rules</span><span class="p">())</span>
    <span class="c1"># A thalamus for that basal ganglia (so it uses the same rules)</span>
    <span class="n">thal</span> <span class="o">=</span> <span class="n">Thalamus</span><span class="p">(</span><span class="n">BG</span><span class="p">)</span>
    <span class="c1"># Define an input; set the input to &#39;state&#39; to D for 100 ms</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>


<span class="n">seq</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">()</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Video:</p>
<iframe width="100%" height="400" src="https://www.youtube.com/embed/jVWrGEmQJlo" frameborder="0" allowfullscreen></iframe><div class="toggle docutils container">
<div class="header docutils container">
<strong>Transcript</strong></div>
<p>The BG network demonstrated in a previous video
is included as a subnetwork of the simulation shown here.
It is connected to cortex, labeled as the ‘state’ population,
which represents the current cortical state of the system.
This projects to basal ganglia.</p>
<p>The most valuable state is selected by BG,
which then projects to thalamus,
disinhibiting an associated action.
The action then changes the state of cortex,
completing the famous cortex-bg-thalamus loop.
This recurrent loop allows the system
to progress through a sequence of states.</p>
<p>Let me begin the simulation.
As you can see, the input is only turned on briefly
for the first 100 milliseconds.
This starts the sequence in state ‘D’.
The subsequent progression through other states
is solely the result of internal dynamics.</p>
<p>We can see the cortical state with the highest utility value in this graph.
BG is selecting the action, or ‘rule’
corresponding to the highest valued state.
The rules in this example cause cortex in state A, to go to state B.
If it is in B, it is changed to C, and so on,
with E being changed back to A.</p>
<p>Pausing the simulation allows us to see this behaviour more clearly.
Now, the highest utility is D,
so the rule that changes state D to E has its action selected.
Stepping ahead allows that rule to take effect,
changing the cortical state to E.
This activates the action to change the cortical state to A.
Which happens when we restart the simulation.</p>
<p>This same progression can be seen in this semantic pointer graph,
where the similarity of all states
to the current cortical state is displayed.
Examining the distance between these peaks
demonstrates that it takes about 40 to 50 milliseconds
to change from one cortical state to the next.</p>
<p>The network is very stable,
and will progress through this set of states
until the simulation is stopped,
or there is other interrupting input.</p>
</div>
</div>
</div>


          </div>
            
  <div class="footer-relations">
    
      <div class="pull-left">
        <a class="btn btn-default" href="basalganglia.html" title="previous chapter (use the left arrow)">Basal Ganglia</a>
      </div>
    
      <div class="pull-right">
        <a class="btn btn-default" href="spa_sequencerouted.html" title="next chapter (use the right arrow)">Routed sequencing</a>
      </div>
    </div>
    <div class="clearer"></div>
  
        </div>
        <div class="clearfix"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="spa_sequencerouted.html" title="Routed sequencing"
             >next</a> |</li>
        <li class="right" >
          <a href="basalganglia.html" title="Basal Ganglia"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Nengo 1.4 1.4 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >Demos</a> &#187;</li> 
      </ul>
    </div>
  <script type="text/javascript">
    $(document).ready(function() {
      $(".toggle > *").hide();
      $(".toggle .header").show();
      $(".toggle .header").click(function() {
        $(this).parent().children().not(".header").toggle(400);
        $(this).parent().children(".header").toggleClass("open");
      });
    });
  </script>

<script type="text/javascript">
  $("#mobile-toggle a").click(function () {
    $("#left-column").toggle();
  });
</script>
<script type="text/javascript" src="../_static/js/bootstrap.js"></script>
  <div class="footer">
    &copy; Copyright 2006-2017, Bryan Tripp & Centre for Theoretical Neuroscience, University of Waterloo. Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  </body>
</html>